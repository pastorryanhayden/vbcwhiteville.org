!function(t){"use strict";function e(e,n,i){t.addEventListener?e.addEventListener(n,i):e.attachEvent("on"+n,i)}function n(t){if(t||(t={}),null==t.container)throw"SquareGallery: options.el is a require";this.container="string"==typeof t.container?document.getElementById(t.container):t.container,this.galleryProperties=this._getPropertiesFromDOM(),this.qtyColumns=t.qtyColumns||2,this.textSquares=t.textSquares||!1,this.containerBGColor=t.containerBGColor||"#fff",this.photoCaptions=t.photoCaptions||!1,this.captionType=t.captionType||1,this.links=t.links||!1,this.qtyImages=this.galleryProperties.images.length,this.columnDivs=[],this.imageCounter=0,this.sequence=this.textSquares?this._generateTextSequence():this._generateSequence(),this._generateColumns()}n.prototype._getPropertiesFromDOM=function(){for(var t=this.container.childNodes,e={path:"./",images:[]},n=0,i=t.length;i>n;n++)if("IMG"===t[n].nodeName){var o={};t[n].getAttribute("data-src")&&(o.file=t[n].getAttribute("data-src")),t[n].getAttribute("data-thumb")&&(o.thumb=t[n].getAttribute("data-thumb")),t[n].getAttribute("data-name")&&(o.name=t[n].getAttribute("data-name")),t[n].getAttribute("data-description")&&(o.description=t[n].getAttribute("data-description")),t[n].getAttribute("data-href")&&(o.href=t[n].getAttribute("data-href")),e.images.push(o)}return this.container.innerHTML="",e},n.prototype._generateColumns=function(){for(var t,e=0,n=0;n<this.qtyColumns;n++)t=document.createElement("div"),t.className="sqr-col",this.containerBGColor&&(t.style.backgroundColor=this.containerBGColor),t.style.width=100/this.qtyColumns+"%",this.container.appendChild(t),this.columnDivs.push(t);for(var i=0,o=this.sequence.length;o>i;i++)e=e>=this.qtyColumns?0:e,this.textSquares?this._insertTextBlock(this.sequence[i],this.columnDivs[e]):this._insertImage(this.sequence[i],this.columnDivs[e]),e++},n.prototype._insertImage=function(t,e){for(var n,i,o,r=this,a=0,s=t;s>a;a++){if(i=this.galleryProperties.images[this.imageCounter],n=document.createElement("div"),n.className=3===t&&0===a?"sqr-square middle":1===t?"sqr-square":"sqr-square small",function(t,e,n){var i=new Image,o=r._setPreloader(t);i.onload=function(){t.style.backgroundImage='url("'+i.src+'")',r.galleryProperties.images[n].width=i.width,r.galleryProperties.images[n].height=i.height,t.removeChild(o),i=null},i.src=e.thumb||e.src}(n,i,this.imageCounter),this.photoCaptions&&null!=i.name)switch(this.captionType){case 1:n.className=n.className+" sqr-caption1",n.setAttribute("data-caption",i.name);break;case 2:n.className=n.className+" sqr-caption2",o=document.createElement("p"),o.appendChild(document.createTextNode(i.name)),n.appendChild(o);break;case 3:n.className=n.className+" sqr-caption3",o=document.createElement("p"),o.appendChild(document.createTextNode(i.name)),n.appendChild(o);break;case 4:n.className=n.className+" sqr-caption4",n.setAttribute("data-caption",i.name);break;case 5:n.className=n.className+" sqr-caption5",n.setAttribute("data-caption",i.name)}e.appendChild(n),this._setAction(n,null!=i.href&&this.links?i.href:this.imageCounter,this.links),this.imageCounter++}},n.prototype._setPreloader=function(t){var e=document.createElement("img");return e.className="sqr-preloader",t.appendChild(e),e},n.prototype._insertTextBlock=function(t,e){for(var n,i,o,r,a,s=this,c=0;t>c;c++)a=this.galleryProperties.images[this.imageCounter],n=document.createElement("div"),n.className=2===t&&1===c?"sqr-text-square small right":2===t?"sqr-text-square small":"sqr-text-square",function(t,e,n){var i=new Image,o=s._setPreloader(t);i.onload=function(){t.style.backgroundImage='url("'+i.src+'")',s.galleryProperties.images[n].width=i.width,s.galleryProperties.images[n].height=i.height,t.removeChild(o),i=null},i.src=e.thumb||e.src}(n,a,this.imageCounter),i=document.createElement("div"),i.className="sqr-text-block",r=document.createElement("h3"),r.appendChild(document.createTextNode(a.name||"")),i.appendChild(r),o=document.createElement("p"),o.appendChild(document.createTextNode(a.description||"")),i.appendChild(o),n.appendChild(i),e.appendChild(n),this._setAction(n,null!=a.href&&this.links?a.href:this.imageCounter,this.links),this.imageCounter++},n.prototype._shuffle=function(t){for(var e,n=[],i=0,o=t.length;o>i;i++){var r=t[i];0==i?n[0]=r:(e=Math.floor(Math.random()*(i+1)),n[i]=n[e],n[e]=r)}return n},n.prototype._moveRepeats=function(t){for(var e=0,n=20,i=[];t.length&&(e===t.length&&(e=0),!(0>n));)i[i.length-1]!==t[e]?(i.push(t[e]),t.splice(e,1)):i[0]!==t[e]?(i.unshift(t[e]),t.splice(e,1)):e++,n--;for(var o=0,r=t.length;r>o;o++)i.push(t[o]);return i},n.prototype._generateSequence=function(){for(var t=[4,3,1],e=this.qtyImages,n=[],i=this.qtyColumns,o=0;e>0;)o=3===o?0:o,e>t[o]?(n.push(t[o]),e-=t[o]):(2===e?n[2]?n[2]=3:(n.push(1),n.push(1)):n.push(e),e=0),o++;for(var r=n.length%i,a=0;r;){var s=Math.floor(Math.random()*(n.length+1));if(4===n[n.length-1]?(n[n.length-1]=3,n.push(1)):3===n[s]&&1===n[n.length-1]&&n.length>4?(n[s]=4,n.pop()):1===n[s]&&3===n[n.length-1]&&n.length>4?(n[s]=4,n.pop()):4===n[s]&&(n[s]=3,n.push(1)),1e3===a)break;a++,r=n.length%i}return this._moveRepeats(n)},n.prototype._generateTextSequence=function(){for(var t=[2,1,1,2],e=this.qtyImages,n=[],i=this.qtyColumns,o=0;e>0;)o=o===t.length?0:o,e>=t[o]?(n.push(t[o]),e-=t[o]):(n.push(e),e=0),o++;for(var r=n.length%i,a=0;r;){var s=Math.floor(Math.random()*(n.length+1));if(2===n[n.length-1]?(n[n.length-1]=1,n.push(1)):1===n[s]&&1===n[n.length-1]&&n.length>4?(n[s]=2,n.pop()):2===n[s]&&(n[s]=1,n.push(1)),100===a)break;a++,r=n.length%i}return n},n.prototype._setAction=function(n,i,o){var r=this;o?e(n,"click",function(){t.location=i}):e(n,"click",function(){new t.Lightbox(n,i,r.galleryProperties)})},t.SquareGallery=n}(this),function(t){function e(){return t.pageYOffset?t.pageYOffset:document.documentElement.clientHeight?document.documentElement.scrollTop:document.body.scrollTop}function n(e,n,i){t.addEventListener?e.addEventListener(n,i):e.attachEvent("on"+n,i)}function i(e,n,i){t.addEventListener?e.removeEventListener(n,i):e.detachEvent("on"+n,i)}function o(t,e,n){this.imgNumber=e,this.imgWidth=this.imgHeight=0,this.container=function(){return t.cloneNode(!1)}(),this.blackOut=document.createElement("div"),this.blackOut.className="sqr-blackout",document.body.appendChild(this.blackOut),this.properties=n,this._initAnimation(t.getBoundingClientRect()),this._renderControls(),this._bindEvents(),this._updatePager()}o.prototype._initAnimation=function(n){var i=this,o=[],r=i.properties.images[this.imgNumber];this.container.style.top=n.top+e()+"px",this.container.style.left=n.left+"px",this.container.style.width=(n.width||n.right-n.left)+"px",this.container.style.height=(n.height||n.bottom-n.top)+"px",this.container.className="sqr-lightbox-container",document.body.appendChild(this.container),t.setTimeout(function(){o=i._fit.call(i,r.width,r.height),i.imgWidth=o[0],i.imgWidth=o[1],i.container.style.width=o[0]+"px",i.container.style.height=o[1]+"px",i.container.style.left=o[2]+"px",i.container.style.top=o[3]+e()+"px",i.blackOut.className=i.blackOut.className+" visible",i._loadImage.call(i,i.imgNumber)},5),t.setTimeout(function(){i.container.className=i.container.className+" no-animation"},500),document.body.style.overflow="hidden"},o.prototype._bindEvents=function(){var t=this;this._destroyByKey=function(e){var n=e.charCode?e.charCode:e.keyCode;n=parseInt(n),39===n?t._next.call(t):37===n?t._prev.call(t):27===n&&t._destroy.call(t)},n(document,"keydown",this._destroyByKey);var e=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,t._destroy.call(t)};n(this.blackOut,"click",e),n(document.getElementById("sqr-close"),"click",e),n(document.getElementById("sqr-left"),"click",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,t._prev.call(t)}),n(document.getElementById("sqr-right"),"click",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,t._next.call(t)}),n(window,"resize",function(){t._resize.call(t)})},o.prototype._updatePager=function(){this.container.setAttribute("data-pager",this.imgNumber+1+" / "+this.properties.images.length)},o.prototype._destroy=function(){i(document,"keydown",this._destroyByKey),document.body.removeChild(this.container),document.body.removeChild(this.blackOut),document.body.style.overflow=""},o.prototype._resize=function(){var t=this._fit(this.imgWidth,this.imgHeight);this.container.style.width=t[0]+"px",this.container.style.height=t[1]+"px",this.container.style.left=t[2]+"px",this.container.style.top=t[3]+e()+"px"},o.prototype._loadImage=function(){var t,n=this,i=document.getElementById("sqr-image");t=new Image,t.onload=function(){if(n.container){n.imgWidth=t.width,n.imgHeight=t.height;var o=n._fit.call(n,t.width,t.height);n.container.style.width=o[0]+"px",n.container.style.height=o[1]+"px",n.container.style.left=o[2]+"px",n.container.style.top=o[3]+e()+"px";var r=document.createElement("img");r.src=t.src,r.className="sqr-image",r.id="sqr-image",i&&n.container.removeChild(i),n.container.appendChild(r),n.container.style.backgroundImage="url()",n._updatePager(),n._removePreloader(),t=null}},t.src=this.properties.images[this.imgNumber].file,this._setPreloader()},o.prototype._setPreloader=function(){if(!document.getElementById("sqr-preloader")){var t=document.createElement("img");t.className="sqr-preloader",t.id="sqr-preloader",this.container.appendChild(t)}},o.prototype._removePreloader=function(){document.getElementById("sqr-preloader")&&this.container.removeChild(document.getElementById("sqr-preloader"))},o.prototype._renderControls=function(){var t=document.createElement("span"),e=document.createElement("span"),n=document.createElement("span");t.className="sqr-icon-close",t.id="sqr-close",e.className="sqr-icon-left",e.id="sqr-left",n.className="sqr-icon-right",n.id="sqr-right",this.blackOut.appendChild(t),this.blackOut.appendChild(e),this.blackOut.appendChild(n)},o.prototype._next=function(){this.imgNumber!==this.properties.images.length-1&&(this.imgNumber++,this._loadImage())},o.prototype._prev=function(){0!==this.imgNumber&&(this.imgNumber--,this._loadImage())},o.prototype._fit=function(e,n){var i=t.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=t.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=55>.05*i?i-110:.9*i,a=30>.05*o?o-60:.9*o;return r>e&&a>n?this._fitOriginal(e,n):e/n>r/a?this._fitWidth(e,n):r/a>e/n?this._fitHeight(e,n):void 0},o.prototype._fitOriginal=function(e,n){var i=t.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=t.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return[e,n,(i-e)/2,(o-n)/2]},o.prototype._fitWidth=function(e,n){var i=t.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=t.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=55>.05*i?i-110:.9*i,a=55>.05*i?55:.05*i,s=Math.round(r/e*n),c=Math.abs((o-s)/2);return[r,s,a,c]},o.prototype._fitHeight=function(e,n){var i=t.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=t.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=30>.05*o?o-60:.9*o,a=30>.05*o?30:.05*o,s=Math.round(r/n*e),c=Math.abs((i-s)/2);return[s,r,c,a]},t.Lightbox=o}(this);